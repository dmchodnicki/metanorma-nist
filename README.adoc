= metanorma-nist: Metanorma processor for the NIST SP 800 document classes

image:https://img.shields.io/gem/v/metanorma-nist.svg["Gem Version", link="https://rubygems.org/gems/metanorma-nist"]
image:https://img.shields.io/travis/riboseinc/metanorma-nist/master.svg["Build Status", link="https://travis-ci.org/riboseinc/metanorma-nist"]
image:https://codeclimate.com/github/riboseinc/metanorma-nist/badges/gpa.svg["Code Climate", link="https://codeclimate.com/github/riboseinc/metanorma-nist"]

WARNING: This gem is still under development.

== Functionality

This gem processes Metanorma documents into the NIST document class.

It provides the following functions:

. Compiles Metanorma input into the Metanorma-NIST XML format
. Validates XML output against the Metanorma-NIST document model
** Errors are reported to console against the XML, and are intended for users to
check that they have provided all necessary components of the
document.
. Metanorma-NIST XML is then converted into desired output formats.

The following outputs are supported:

* Primary: the canonical Metanorma-NIST XML representation (`.xml`).
* Secondary: the Metanorma-NIST XML representation is processed to generate the following outputs
as end deliverable NIST documents.
** HTML (`.html`)
** PDF (`.pdf`)
** Word (`.doc`)

== Structure

This gem inherits from the https://github.com/riboseinc/metanorma-standoc
gem, and aligns closely to it.


=== Quickstart

Please see https://www.metanorma.com for instructions to get started.

If you are using a Mac, the https://github.com/riboseinc/metanorma-macos-setup
repository has instructions on setting up your machine to run Metanorma
scripts such as this one. You need only run the following in a Terminal console:

[source,console]
----
$ bash <(curl -s https://raw.githubusercontent.com/riboseinc/metanorma-macos-setup/master/metanorma-setup)
$ gem install metanorma-cli
$ gem install metanorma-nist
----


== Usage

Using the `metanorma` CLI:

[source,console]
----
$ metanorma --type ogc a.adoc                   # output HTML
$ metanorma --type ogc --extensions html a.adoc # output just HTML
$ metanorma --type ogc --extensions xml a.adoc  # output Metanorma XML
----


== Authoring

Please refer to the Metanorma-ISO documentation for general documentation.

* Metanorma-ISO general documentation: https://www.metanorma.com/software/metanorma-iso/

* Metanorma-ISO guidance: https://www.metanorma.com/software/metanorma-iso/docs/guidance/


////
** http://asciimath.org[AsciiMathML] is used for mathematical formatting.
The gem uses the https://github.com/asciidoctor/asciimath[Ruby AsciiMath parser],
which is syntactically stricter than the common MathJax processor;
if you do not get expected results, try bracketing terms your in AsciiMathML
expressions.
////


== Approach

=== Document model

The NIST SP 800 document model is detailed here:

* https://github.com/riboseinc/metanorma-model-nist[NIST SP 800 document model]

It is an instance of the
https://github.com/riboseinc/metanorma-model-standoc[StandardDocument model].


=== Document input

Document input to Metanorma is for the compilation of content into the
Metanorma XML document.

The Metanorma-NIST processor supports AsciiDoc input.

Similar to Markdown, AsciiDoc is a lightweight markup format, but
combines the rigor and expressivity of DocBook.
A number of editors (through plugins) support preview of AsciiDoc files,
so textual content can be previewed without running the Metanorma toolchain.

The Metanorma processor automates numbering of headings, figures,
tables etc, automatically generates references and citations,
and  the resulting output presentations.

NOTE: The Asciidoctor gem is used for AsciiDoc input parsing.


== Document attributes

=== Common attributes

Metadata of the document is provided through AsciiDoc document attributes.

https://github.com/riboseinc/metanorma-standoc[Metanorma-Standoc]
documents all common Metanorma document attributes.

////
TODO.

Where these preexisting metanorma attributes correspond to attributes already used
by NIST in their Asciidoctor template, they are treated as synonyms of the Metanorma
attributes.

The attributes relevant to OGC documents include:

`:edition:`:: The document version; e.g. `2.0`.

`:revdate:`:: The date the document was last updated.

`:copyright-year:` (OGC: `:copyrightYear`):: The year which will be claimed as when the copyright for
the document was issued.

`:title:`:: The main component of the English title of the document
(mandatory). (The first line of the AsciiDoc document, which contains the title
introduced with `=`, is ignored)

`:doctype:`:: The document type (mandatory). The permitted types are:
+
--
* Standards
`standard`::: Implementation Standard
`standard-with-suite`::: Implementation Standard with Compliance Suite
`abstract-specification`::: Abstract Specification
`community-standard`::: Community Standard
`profile`::: Profile / Application Profile
`best-practice`::: Best Practices Document

* Other
`engineering-report`::: Engineering Report
`discussion-paper`::: Discussion Paper
`reference-model`::: OGC Reference Model
`user-guide`::: User Guide
`policy`::: OGC Policy Document
`guide`::: Guide
`amendment`::: Technical Amendment
`technical-corrigendum`::: Corrigendum (errata) Changes to OGC Standards
`administrative`::: Internal administrative documents
--

`:status:`:: Document status/stage. The permitted types are:
+
`rfc`::: OGC RFC (proposal)
`candidate`::: Candidate Standard
`published`::: Published
`deprecated`::: Deprecated
`retired`::: Retired

`:committee:`:: The name of the relevant committee producing the document (mandatory). The legal values are:
`technical`, `planning`, `strategic-member-advisory`
`:subcommittee:`:: The name of the relevant subcommittee producing the document
`:workgroup:` (OGC: `:workingGroup:`):: The name of the relevant working group producing the document (mandatory)

`:language:`:: The language of the document (e.g. `en`) (mandatory)

`:published-date:` (OGC: `:publicationDate:`):: The publication date for the document.
`:issued-date:`  (OGC: `:approvalDate:`):: The approval date for the document.
`:created-date:`:: The creation date for the document.
`:received-date:`  (OGC: `:submissionDate:`):: The date at which the document was submitted to the standards body.

`:uri:`:: The URI to which this standard is published.
`:xml-uri:`:: The URI for the Metanorma XML as which this standard is published.
`:pdf-uri:`:: The URI for the PDF as which this standard is published.
`:doc-uri:`:: The URI for the DOC as which this standard is published.
`:docnumber:`  (OGC: `docReference`):: The internal identifier referring to this document.

`:draft:`:: If present, review notes are included in the
Metanorma XML output; otherwise they are suppressed.


=== OGC-specific attributes

The following document attributes are specific to this document class:

`:external-id:`:: The external identifier referring to this document.
`:referenceURLID:`:: The identifier embedded into a document type-specific
external URL.
`:previous-uri:`:: URI of previous version of the document.
`:subcommittee-type:`:: The type of the relevant subcommittee producing the document
`:subcommittee-number:`:: The number of the relevant subcommittee producing the document
`:workgroup-type:`:: The type of the relevant workgroup producing the document
`:workgroup-number:`:: The number of the relevant workgroup producing the document

`:keywords:`:: Comma-delimited list of the keywords associated with the document.
`:submitting-organizations:`:: Semicolon-delimited list of the submitting organisations
for this document. (The organisation names themselves may contain commas; e.g.
`University of Calgary, Canada; National Central University, Taiwan`.

`:fullname{_i}:`:: The full name of a person who is a contributor to the document.
A second person is indicated by using a numeric suffix: `:fullname:`, `:fullname_2:`, `fullname_3:`, &c.

`:surname{_i}:`:: The surname of a person who is a contributor to the document.
`:givenname{_i}:`:: The given name(s) of a person who is a contributor to the document.
`:role{_i}:`:: The role of a a person who is a contributor to the document. By default,
they are coded as an `editor`; they can also be represented as an `author`.

OGC `:editor:`:: corresponds to `:fullname:` with `role` = "editor"
////

== Asciidoctor features specific to NIST

The https://github.com/riboseinc/metanorma-standoc[metanorma-standoc]
gem documents the customisations of Asciidoctor markup common to all metanorma gems.
The following markup is specific to this gem:

=== Pseudocode

Pseudocode shall be marked up as an example, with style attribute "pseudocode":

[source,asciidoctor]
----
[pseudocode]
====
_Input: S=(s1,...,sL)_

_Output:_ Shuffled _S=(s1,...,sL)_

. *for* _i_ *from* _L_ *downto* 1 *do*
.. Generate a random integer _j_ such that 1<=_j_<=_i_
.. Swap _s~j~_ and _s~i~_
====
----

////

== Examples

////
* link:spec/examples/rfc6350.adoc[] is an Metanorma AsciiDoc version of https://tools.ietf.org/html/rfc6350[RFC 6350].
* link:spec/examples/rfc6350.html[] is an HTML file generated from the Asciidoctor.
* link:spec/examples/rfc6350.doc[] is a Word document generated from the Asciidoctor.

////

